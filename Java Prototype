
// EJERCICIO 1: PATR칍N PROTOTYPE

// C칍DIGO INICIAL (PROBLEMA)
class GraphicElementProblema {
    private String type;
    private int x;
    private int y;
    private String style;
    
    public GraphicElementProblema(String type, int x, int y, String style) {
        this.type = type;
        this.x = x;
        this.y = y;
        this.style = style;
        
        // Simulaci칩n de operaci칩n costosa
        System.out.println(" Creando elemento gr치fico costoso...");
        try {
            Thread.sleep(2000); // Simula carga de recursos
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println(" Elemento creado: " + type);
    }
    
    public void setX(int x) { this.x = x; }
    public void setY(int y) { this.y = y; }
    
    @Override
    public String toString() {
        return String.format("GraphicElement[type=%s, x=%d, y=%d, style=%s]", 
                           type, x, y, style);
    }
}

//SOLUCI칍N CON PATR칍N PROTOTYPE
class GraphicElement implements Cloneable {
    private String type;
    private int x;
    private int y;
    private String style;
    
    public GraphicElement(String type, int x, int y, String style) {
        this.type = type;
        this.x = x;
        this.y = y;
        this.style = style;
        
        // Simulaci칩n de operaci칩n costosa
        System.out.println(" Creando elemento gr치fico costoso...");
        try {
            Thread.sleep(2000); // Simula carga de recursos
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println(" Elemento creado: " + type);
    }
    
    // Implementaci칩n del patr칩n Prototype seg칰n las instrucciones
    @Override
    public GraphicElement clone() {
        try {
            return (GraphicElement) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new AssertionError(); // No puede ocurrir ya que implementamos Cloneable
        }
    }
    
    public void setX(int x) { this.x = x; }
    public void setY(int y) { this.y = y; }
    
    @Override
    public String toString() {
        return String.format("GraphicElement[type=%s, x=%d, y=%d, style=%s]", 
                           type, x, y, style);
    }
}


// EJERCICIO 2: PATR칍N SINGLETON

//C칍DIGO INICIAL (PROBLEMA)
class AppConfigProblema {
    private String theme;
    private String language;
    
    public AppConfigProblema() {
        this.theme = "Dark";
        this.language = "ES";
        System.out.println(" Configuraci칩n creada: " + this);
    }
    
    public void setTheme(String theme) { this.theme = theme; }
    public void setLanguage(String language) { this.language = language; }
    public String getTheme() { return theme; }
    public String getLanguage() { return language; }
    
    @Override
    public String toString() {
        return String.format("AppConfig[theme=%s, language=%s]", theme, language);
    }
}

// SOLUCI칍N CON PATR칍N SINGLETON (Eager Initialization)
class AppConfig {
    // Paso 2: Instancia est치tica y privada (Eager Initialization)
    private static final AppConfig instance = new AppConfig();
    
    private String theme;
    private String language;
    
    // Paso 1: Constructor privado
    private AppConfig() {
        this.theme = "Dark";
        this.language = "ES";
        System.out.println("游댢 Configuraci칩n Singleton creada: " + this);
    }
    
    // Paso 3: M칠todo getter p칰blico y est치tico
    public static AppConfig getInstance() {
        return instance;
    }
    
    public void setTheme(String theme) { this.theme = theme; }
    public void setLanguage(String language) { this.language = language; }
    public String getTheme() { return theme; }
    public String getLanguage() { return language; }
    
    @Override
    public String toString() {
        return String.format("AppConfig[theme=%s, language=%s]", theme, language);
    }
}

// CLASE PRINCIPAL - DEMOSTRACI칍N
public class Main {
    public static void main(String[] args) {
        System.out.println("=".repeat(60));
        System.out.println("EJERCICIO 1: PATR칍N PROTOTYPE");
        System.out.println("=".repeat(60));
        
        demoPrototypeProblema();
        System.out.println();
        demoPrototypeSolucion();
        
        System.out.println("\n" + "=".repeat(60));
        System.out.println("EJERCICIO 2: PATR칍N SINGLETON");
        System.out.println("=".repeat(60));
        
        demoSingletonProblema();
        System.out.println();
        demoSingletonSolucion();
    }
    
    //DEMOSTRACI칍N PROTOTYPE: PROBLEMA
    private static void demoPrototypeProblema() {
        System.out.println("\n SIN PATR칍N PROTOTYPE:");
        long inicio = System.currentTimeMillis();
        
        GraphicElementProblema button1 = new GraphicElementProblema(
            "StyledButton", 10, 20, "gradient-shadow"
        );
        
        GraphicElementProblema button2 = new GraphicElementProblema(
            "StyledButton", 40, 60, "gradient-shadow"
        );
        
        long fin = System.currentTimeMillis();
        System.out.println(" Tiempo total: " + (fin - inicio) + "ms");
    }
    
    //DEMOSTRACI칍N PROTOTYPE: SOLUCI칍N
    private static void demoPrototypeSolucion() {
        System.out.println("\n CON PATR칍N PROTOTYPE:");
        long inicio = System.currentTimeMillis();
        
        // Creamos el prototipo una sola vez (operaci칩n costosa)
        GraphicElement button1 = new GraphicElement(
            "StyledButton", 10, 20, "gradient-shadow"
        );
        
        // Uso del patr칩n seg칰n las instrucciones
        GraphicElement button2 = button1.clone(); // 춰Ahora esto es muy r치pido!
        button2.setX(40);
        button2.setY(60);
        
        long fin = System.currentTimeMillis();
        System.out.println(" Tiempo total: " + (fin - inicio) + "ms");
        System.out.println(" Button1: " + button1);
        System.out.println(" Button2: " + button2);
    }
    
    //DEMOSTRACI칍N SINGLETON: PROBLEMA
    private static void demoSingletonProblema() {
        System.out.println("\n SIN PATR칍N SINGLETON:");
        
        AppConfigProblema config1 = new AppConfigProblema();
        config1.setTheme("Light");
        
        AppConfigProblema config2 = new AppConfigProblema();
        
        System.out.println("Config1: " + config1);
        System.out.println("Config2: " + config2);
        System.out.println("쯉on el mismo objeto? " + (config1 == config2));
        System.out.println(" Problema: M칰ltiples instancias con configuraciones inconsistentes!");
    }
    
    //DEMOSTRACI칍N SINGLETON: SOLUCI칍N
    private static void demoSingletonSolucion() {
        System.out.println("\n CON PATR칍N SINGLETON:");
        
        // Paso 4: Uso de getInstance() en lugar de new
        AppConfig config1 = AppConfig.getInstance();
        config1.setTheme("Light");
        
        AppConfig config2 = AppConfig.getInstance();
        
        System.out.println("Config1: " + config1);
        System.out.println("Config2: " + config2);
        System.out.println("쯉on el mismo objeto? " + (config1 == config2));
        System.out.println(" 칄xito: Una 칰nica instancia compartida!");
    }
}
